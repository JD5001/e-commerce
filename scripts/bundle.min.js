console.log("E-Commerce Website Loaded");const productGrid=document.getElementById("product-grid");function updateCartCount(){const t=document.querySelector(".cart-count"),e=(JSON.parse(localStorage.getItem("cart"))||[]).reduce((t,e)=>t+(e.quantity||0),0);t.textContent=e}function addToCart(t){if(!t.quantity||t.quantity<1)return void showAddToCartFeedback("Quantity must be at least 1.");let e=JSON.parse(localStorage.getItem("cart"))||[];const o=e.findIndex(e=>e.id===t.id);-1!==o?e[o].quantity=(e[o].quantity||1)+(t.quantity||1):e.push(t),localStorage.setItem("cart",JSON.stringify(e)),updateCartCount(),showAddToCartFeedback(`Added "${t.title}" to cart.`)}function removeFromCart(t){let e=JSON.parse(localStorage.getItem("cart"))||[];e=e.filter(e=>e.id!==t),localStorage.setItem("cart",JSON.stringify(e)),updateCartCount(),showAddToCartFeedback("Item removed from cart.")}function showAddToCartFeedback(t){let e=document.getElementById("add-to-cart-feedback");e||(e=document.createElement("div"),e.id="add-to-cart-feedback",e.style.position="fixed",e.style.top="10px",e.style.right="10px",e.style.backgroundColor="#4caf50",e.style.color="white",e.style.padding="10px 20px",e.style.borderRadius="5px",e.style.boxShadow="0 2px 6px rgba(0,0,0,0.3)",e.style.zIndex="1000",e.style.opacity="0",e.style.transition="opacity 0.5s ease-in-out",document.body.appendChild(e)),e.textContent=t,e.style.opacity="1",setTimeout(()=>{e.style.opacity="0"},3e3)}function createProductCard(t){const e=document.createElement("div");e.className="product-card";const o=document.createElement("img");o.className="product-image",o.src=t.image,o.alt=t.title,o.loading="lazy",o.style.cursor="pointer",o.onclick=()=>{window.location.href=`product.html?id=${t.id}`};const n=document.createElement("div");n.className="product-title",n.textContent=t.title,n.style.cursor="pointer",n.onclick=()=>{window.location.href=`product.html?id=${t.id}`};const a=document.createElement("div");a.className="product-price",a.textContent=`$${t.price.toFixed(2)}`;const i=document.createElement("button");return i.className="add-to-cart-btn",i.textContent="Add to Cart",i.onclick=()=>{addToCart({...t,quantity:1})},e.appendChild(o),e.appendChild(n),e.appendChild(a),e.appendChild(i),e}function renderProducts(t){productGrid.innerHTML="",t.forEach(t=>{const e=createProductCard(t);productGrid.appendChild(e)})}function showLoading(){productGrid.innerHTML="<p>Loading products...</p>"}function showError(t){productGrid.innerHTML=`<p class="error-message">${t}</p>`}function fetchProducts(){showLoading(),fetch("https://fakestoreapi.com/products").then(t=>{if(!t.ok)throw new Error("Network response was not ok");return t.json()}).then(t=>{renderProducts(t),updateCartCount()}).catch(t=>{showError("Failed to load products. Please try again later."),console.error("Fetch error:",t)})}function updateCartCount(){const t=document.querySelector(".cart-count"),e=(JSON.parse(localStorage.getItem("cart"))||[]).reduce((t,e)=>t+(e.quantity||0),0);t.textContent=e}function renderCartItems(){const t=JSON.parse(localStorage.getItem("cart"))||[],e=document.getElementById("cart-items-container");e.innerHTML="",0!==t.length?t.forEach(t=>{const o=document.createElement("div");o.className="cart-item";const n=document.createElement("img");n.src=t.image,n.alt=t.title,n.className="cart-item-image";const a=document.createElement("div");a.className="cart-item-title",a.textContent=t.title;const i=document.createElement("div");i.className="cart-item-options",t.options&&(i.textContent="Options: "+Object.entries(t.options).map(([t,e])=>`${t}: ${e}`).join(", "));const r=document.createElement("div");r.className="cart-item-quantity-container";const c=document.createElement("span");c.textContent="Quantity: ";const d=document.createElement("button");d.textContent="âˆ’",d.className="quantity-btn minus-btn",d.onclick=()=>{t.quantity>1&&updateItemQuantity(t.id,t.quantity-1)};const s=document.createElement("input");s.type="number",s.min="1",s.value=t.quantity,s.className="cart-item-quantity-input",s.onchange=e=>{const o=parseInt(e.target.value);if(o<1)return e.target.value=t.quantity,void alert("Quantity must be at least 1.");updateItemQuantity(t.id,o)};const l=document.createElement("button");l.textContent="+",l.className="quantity-btn plus-btn",l.onclick=()=>{updateItemQuantity(t.id,t.quantity+1)},r.appendChild(c),r.appendChild(d),r.appendChild(s),r.appendChild(l);const u=document.createElement("div");u.className="cart-item-price",u.textContent=`Price: $${(t.price*t.quantity).toFixed(2)}`;const p=document.createElement("button");p.className="cart-item-remove-btn",p.textContent="Remove",p.onclick=()=>{removeFromCart(t.id)},o.appendChild(n),o.appendChild(a),o.appendChild(i),o.appendChild(r),o.appendChild(u),o.appendChild(p),e.appendChild(o)}):e.innerHTML="<p>Your cart is empty.</p>"}function updateItemQuantity(t,e){let o=JSON.parse(localStorage.getItem("cart"))||[];const n=o.findIndex(e=>e.id===t);-1!==n&&(o[n].quantity=e,localStorage.setItem("cart",JSON.stringify(o)),renderCartItems(),updateCartCount(),updateTotalPrice(),updateCheckoutButtonState())}function removeFromCart(t){let e=JSON.parse(localStorage.getItem("cart"))||[];e=e.filter(e=>e.id!==t),localStorage.setItem("cart",JSON.stringify(e)),renderCartItems(),updateCartCount(),updateTotalPrice(),updateCheckoutButtonState()}function updateCheckoutButtonState(){const t=JSON.parse(localStorage.getItem("cart"))||[],e=document.getElementById("proceed-to-checkout-btn");e&&(e.disabled=0===t.length)}function updateTotalPrice(){const t=(JSON.parse(localStorage.getItem("cart"))||[]).reduce((t,e)=>t+e.price*e.quantity,0),e=document.getElementById("cart-total");e&&(e.textContent=`Total: $${t.toFixed(2)}`)}fetchProducts(),document.addEventListener("DOMContentLoaded",()=>{const t=document.getElementById("hamburger-menu"),e=document.querySelector(".nav-menu");t.addEventListener("click",()=>{"flex"===e.style.display?e.style.display="none":(e.style.display="flex",e.style.flexDirection="column")})}),console.log("Cart Page Loaded"),document.addEventListener("DOMContentLoaded",()=>{updateCartCount(),renderCartItems();document.getElementById("continue-shopping-btn").onclick=()=>{window.location.href="index.html"};const t=document.querySelector("main.container"),e=document.createElement("div");e.id="cart-total",e.style.fontWeight="bold",e.style.fontSize="1.2em",e.style.marginTop="20px",t.appendChild(e);const o=document.createElement("button");o.id="proceed-to-checkout-btn",o.textContent="Proceed to Checkout",o.style.marginLeft="10px",o.disabled=!0,o.onclick=()=>{window.location.href="checkout.html"},t.appendChild(o),updateTotalPrice(),updateCheckoutButtonState()});import{initializeApp}from"https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js";import{getAuth,createUserWithEmailAndPassword,signInWithEmailAndPassword,signOut,onAuthStateChanged}from"https://www.gstatic.com/firebasejs/9.22.2/firebase-auth.js";const firebaseConfig={apiKey:"AIzaSyDI2ZBMpFRdTAF68a9vUg_sitW08Jjc_ws",authDomain:"ecommerce-frontend-47dad.firebaseapp.com",projectId:"ecommerce-frontend-47dad",storageBucket:"ecommerce-frontend-47dad.firebasestorage.app",messagingSenderId:"427360728962",appId:"1:427360728962:web:52ebf1489ec88dea8c019b",measurementId:"G-17JE2244RJ"};import{setPersistence,browserLocalPersistence}from"https://www.gstatic.com/firebasejs/9.22.2/firebase-auth.js";const app=initializeApp(firebaseConfig),auth=getAuth(app);setPersistence(auth,browserLocalPersistence).catch(t=>{console.error("Failed to set auth persistence:",t)});export{auth,createUserWithEmailAndPassword,signInWithEmailAndPassword,signOut,onAuthStateChanged};import imagemin from"imagemin";import imageminWebp from"imagemin-webp";import imageminPngquant from"imagemin-pngquant";import imageminMozjpeg from"imagemin-mozjpeg";import sharp from"sharp";import path from"path";import fs from"fs";const inputDir=path.resolve("images"),outputDir=path.resolve("optimized-images"),sizes=[320,640,1280];async function optimizeImages(){fs.existsSync(inputDir)||(console.error(`Input directory "${inputDir}" does not exist. Please add images to optimize.`),process.exit(1)),fs.existsSync(outputDir)||fs.mkdirSync(outputDir);const t=fs.readdirSync(inputDir).filter(t=>/\.(png|jpe?g)$/i.test(t));for(const e of t){const t=path.join(inputDir,e),o=path.extname(e).toLowerCase(),n=path.basename(e,o);for(const e of sizes){const a=`${n}-${e}${o}`,i=path.join(outputDir,a);await sharp(t).resize(e).toFile(i);const r=`${n}-${e}.webp`,c=path.join(outputDir,r);await sharp(t).resize(e).webp({quality:75}).toFile(c)}}console.log("Responsive image optimization complete. Optimized images are in:",outputDir)}function getProductIdFromUrl(){return new URLSearchParams(window.location.search).get("id")}function showLoading(){document.querySelector(".product-detail-container").innerHTML="<p>Loading product details...</p>"}function showError(t){document.querySelector(".product-detail-container").innerHTML=`<p class="error-message">${t}</p>`}function updateCartCount(){const t=document.querySelector(".cart-count"),e=(JSON.parse(localStorage.getItem("cart"))||[]).reduce((t,e)=>t+(e.quantity||0),0);t.textContent=e}function addToCart(t,e,o,n){let a=JSON.parse(localStorage.getItem("cart"))||[];const i=a.findIndex(e=>e.id===t.id&&e.size===o&&e.color===n);if(-1!==i)a[i].quantity+=e;else{const i={id:t.id,title:t.title,price:t.price,image:t.image,quantity:e,size:o,color:n};a.push(i)}localStorage.setItem("cart",JSON.stringify(a)),updateCartCount();const r=document.getElementById("add-to-cart-feedback");r&&(r.textContent=`Added ${e} x "${t.title}" (Size: ${o}, Color: ${n}) to cart.`,showAddToCartAnimation())}function fetchProductDetails(t){showLoading(),fetch(`https://fakestoreapi.com/products/${t}`).then(t=>{if(!t.ok)throw new Error("Failed to fetch product details");return t.json()}).then(t=>{populateProductDetails(t)}).catch(e=>{console.warn("Fetch failed, loading mock product data for local testing.",e);populateProductDetails({id:t,title:"Mock Product",description:"This is a mock product description for local testing.",price:19.99,image:"https://via.placeholder.com/400",variations:{size:["Small","Medium","Large"],color:["Red","Blue","Green"]}})})}function populateProductDetails(t){const e=document.getElementById("product-main-image"),o=document.getElementById("product-title"),n=document.getElementById("product-description"),a=document.getElementById("product-price"),i=document.getElementById("add-to-cart-btn"),r=document.getElementById("size-select"),c=document.getElementById("color-select"),d=document.getElementById("quantity-input"),s=document.getElementById("quantity-decrease"),l=document.getElementById("quantity-increase");console.log("DOM Elements:",{imgElem:e,titleElem:o,descElem:n,priceElem:a,addToCartBtn:i,sizeSelect:r,colorSelect:c,quantityInput:d,quantityDecrease:s,quantityIncrease:l}),e.src=t.image,e.alt=t.title;const u=t.image.replace(/\.[^/.]+$/,""),p=t.image.split(".").pop();function m(){const e=(t.price*parseInt(d.value)).toFixed(2);a.textContent=`$${e}`}e.srcset=`\n        ${u}-320.${p} 320w,\n        ${u}-640.${p} 640w,\n        ${u}-1280.${p} 1280w,\n        ${u}-320.webp 320w,\n        ${u}-640.webp 640w,\n        ${u}-1280.webp 1280w\n    `,e.sizes="(max-width: 600px) 320px, (max-width: 900px) 640px, 1280px",o.textContent=t.title,n.textContent=t.description,a.textContent=`$${t.price.toFixed(2)}`,t.variations&&(populateVariationOptions(r,t.variations.size),populateVariationOptions(c,t.variations.color)),s.onclick=()=>{let t=parseInt(d.value);t>1&&(d.value=t-1,m())},l.onclick=()=>{let t=parseInt(d.value);t<10&&(d.value=t+1,m())},d.oninput=()=>{let t=parseInt(d.value);isNaN(t)||t<1?d.value=1:t>10&&(d.value=10),m()},r.onchange=()=>{highlightSelectedOption(r)},c.onchange=()=>{highlightSelectedOption(c)},i.onclick=()=>{const e=parseInt(d.value),o=r.value,n=c.value;addToCart(t,e,o,n)},m(),setupImageZoom(e)}function populateVariationOptions(t,e){t&&e&&(t.innerHTML="",e.forEach(e=>{const o=document.createElement("option");o.value=e.toLowerCase(),o.textContent=e,t.appendChild(o)}),highlightSelectedOption(t))}function highlightSelectedOption(t){const e=t.options;for(let t=0;t<e.length;t++)e[t].style.fontWeight=e[t].selected?"bold":"normal",e[t].style.color=e[t].selected?"#ff6f61":"#000"}function showAddToCartAnimation(){const t=document.getElementById("add-to-cart-feedback");t&&(t.style.opacity=0,t.style.display="block",t.style.transition="opacity 0.5s ease-in-out",t.style.opacity=1,setTimeout(()=>{t.style.opacity=0,setTimeout(()=>{t.style.display="none"},500)},3e3))}function setupImageZoom(t){const e=document.getElementById("zoom-result");if(!e||!t)return;t.addEventListener("mousemove",function(o){e.style.display="block";const n=t.getBoundingClientRect(),a=o.clientX-n.left,i=o.clientY-n.top,r=a/n.width*100,c=i/n.height*100;e.style.backgroundImage=`url('${t.src}')`,e.style.backgroundPosition=`${r}% ${c}%`}),t.addEventListener("mouseleave",function(){e.style.display="none"});let o=!1;t.addEventListener("click",function(){o?(e.style.display="none",o=!1):(e.style.display="block",e.style.backgroundImage=`url('${t.src}')`,o=!0)})}optimizeImages().catch(t=>{console.error("Error optimizing images:",t),process.exit(1)}),dconsole.log("Product Detail Page Loaded"),document.addEventListener("DOMContentLoaded",()=>{updateCartCount();const t=getProductIdFromUrl();t?fetchProductDetails(t):showError("No product ID specified.")});